<div class="overlay" ng-show="$ctrl.loading">
    loading...
</div>

<div class="overlay" ng-show="$ctrl.mode == 'order' && $ctrl.cycle.did_order">
    You already placed an order this cycle.
</div>


<div>
    <div class="inventory-toolbar">
        <div ng-switch="$ctrl.InventoryService.mode" class="no-animate">
            <div ng-switch-default class="no-animate">


                <div class="row-fluid top">
                    <!--<div class="pull-left">
                        <button type="button" class="btn btn-default" ng-click="$ctrl.InventoryService.load()"><span
                                class="fa fa-undo"></span></button>
                        <button type="button" class="btn btn-default" ng-click="$ctrl.InventoryService.save()"><span
                                class="fa fa-repeat"></span></button>
                    </div>-->
                    <!-- <div class="pull-left well-sm inventory-order-info">
                        &lt;!&ndash;<span class="label label-default">
                            Total Budget: {{$ctrl.CycleService.current_cycle.budget | currency:"$"}}
                        </span>&ndash;&gt;
                        <h3>
                            <span class="label label-info">
                             Total Budget: {{$ctrl.CycleService.current_cycle.budget | currency:"$"}}
                            </span>
                        </h3>
                        <span>|</span>
                        <h3>
                            <span class="label"
                                  ng-class="{'label-success' : $ctrl.CycleService.current_cycle.balance > 0, 'label-danger' : $ctrl.CycleService.current_cycle.balance <= 0}">
                            Avail Balance: {{$ctrl.CycleService.current_cycle.balance | currency:"$"}}
                            </span>
                        </h3>
                        <span class="badge"><span class="fa fa-minus"></span> </span>
                        <h3>
                            <span class="label label-primary">
                            Order Total:  {{($ctrl.orderTotal || 0) | currency:"$"}}
                            </span>
                        </h3>
                        <span class="badge">=</span>
                        <h3>
                            <span class="label"
                                  ng-class="{'label-success' : $ctrl.CycleService.current_cycle.balance - $ctrl.orderTotal > 0, 'label-danger' : $ctrl.CycleService.current_cycle.balance - $ctrl.orderTotal <= 0}"
                            >
                            New Balance: {{$ctrl.CycleService.current_cycle.balance - $ctrl.orderTotal | currency:"$"}}
                            </span>
                        </h3>

                    </div>-->
                    <div  style="margin-bottom: 15px;" class="row">
                        <div class="col-md-9">
                            <div class="well light">

                                {{$ctrl.CycleService.remainingTime.toString()}}


                            </div>

                        </div>
                        <div class="col-md-3">
                            <div class="btn-group btn-group-justified" role="group" aria-label="...">
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-danger fat-btn">Reset</button>
                                </div>
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-success fat-btn" ng-click="$ctrl.handleCommit()">Commit</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row inv-balance-info">
                        <div class="col-md-3">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    <h3>Total Budget</h3>
                                    <h3 class="text-right">
                                        <span class="label label-primary">
                                            {{$ctrl.CycleService.current_cycle.budget | currency:"$"}}
                                        </span>
                                    </h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    <h3>Available Balance</h3>
                                    <h3 class="text-right">
                                        <span class="label label-primary">
                                            {{$ctrl.CycleService.current_cycle.balance | currency:"$"}}
                                        </span>
                                    </h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    <h3>Order Total</h3>
                                    <h3 class="text-right">
                                        <span class="label label-primary">
                                            {{($ctrl.orderTotal || 0) | currency:"$"}}
                                        </span>
                                    </h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    <h3>New Balance</h3>
                                    <h3 class="text-right">
                                        <span class="label label-primary">
                                            {{$ctrl.CycleService.current_cycle.balance - $ctrl.orderTotal | currency:"$"}}
                                        </span>
                                    </h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!--<div class="row-fluid middle">
                    <ul class="nav nav-tabs">
                        <li role="presentation" class="active"><a href="#" ng-init="showFilter = true"
                                                                  ng-click="showFilter = !showFilter">Filter</a></li>
                        <li role="presentation"><a href="#">...</a></li>
                        <li role="presentation"><a href="#">...</a></li>
                    </ul>
                </div>-->



                <div class="row-fluid bottom">
                    <form class="form-inline">
                        <div class="form-group">
                            <label for="exampleInputName2" class="hidden-xs">
                        <span class="fa"
                              ng-class="{'fa-caret-up' : $ctrl.sort === 'name ASC', 'fa-caret-down' : $ctrl.sort === 'name DESC'}"></span>
                                <span class="inventory-toggle-sort" ng-click="$ctrl.toggleSort('name')">Name</span>
                            </label>
                            <input placeholder="Name" type="text" class="form-control input-sm"
                                   ng-model="$ctrl.filter.name"
                                   ng-change="$ctrl.handleFilterChange()"
                                   ng-model-options="{ allowInvalid: true, debounce: 200 }">
                            <span class="fa fa-remove generic-remove-btn" ng-show="$ctrl.filter.name"
                                  ng-click="$ctrl.clearFilterItem('name')">&nbsp;</span>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputName2" class="hidden-xs">
                        <span class="fa"
                              ng-class="{'fa-caret-up' : $ctrl.sort === 'category_id ASC', 'fa-caret-down' : $ctrl.sort === 'category_id DESC'}"></span>
                                <span class="inventory-toggle-sort"
                                      ng-click="$ctrl.toggleSort('category_id')">Category</span>
                            </label>
                            <select ng-change="$ctrl.handleFilterChange()"
                                    ng-model-options="{ allowInvalid: true, debounce: 200 }"
                                    class="form-control input-sm"
                                    ng-options="category.category_id as category.name for category in $ctrl.categories"
                                    ng-model="$ctrl.filter.category_id">
                                <option>asdf</option>
                            </select>

                            <span class="fa fa-remove generic-remove-btn" ng-show="$ctrl.filter.category_id"
                                  ng-click="$ctrl.clearFilterItem('category_id')">&nbsp;</span>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputName2" class="hidden-xs">
                        <span class="fa"
                              ng-class="{'fa-caret-up' : $ctrl.sort === 'quantity ASC', 'fa-caret-down' : $ctrl.sort === 'quantity DESC'}"></span>
                                <span class="inventory-toggle-sort"
                                      ng-click="$ctrl.toggleSort('quantity')">Quantity</span>
                            </label>
                            <!--<select  class="form-control input-sm" ng-model="$ctrl.filter.quantityMod">
                                <option >==</option>
                                <option >&gt;</option>
                                <option >&lt;</option>

                            </select>-->
                            <input style="width:100px;" ng-model="$ctrl.filter.quantity" type="number"
                                   class="form-control input-sm" id="exampleInputName2" placeholder="0"
                                   ng-change="$ctrl.handleFilterChange()"
                                   ng-model-options="{ allowInvalid: true, debounce: 200 }">
                            <span class="fa fa-remove generic-remove-btn " ng-show="$ctrl.filter.quantity"
                                  ng-click="$ctrl.clearFilterItem('quantity')">&nbsp;</span>
                        </div>
                    </form>
                </div>


            </div>
            <div ng-switch-when="report" class="no-animate">
                <div class="row-fluid top">
                    <div class="pull-right well-sm">
                        {{$ctrl.CycleService.remainingTime.toString()}}
                    </div>
                    <div class="pull-right well-sm">
                        Balance: {{$ctrl.orderTotal}}
                    </div>
                    <div class="clearfix"></div>
                </div>
                <div class="row-fluid middle">
                    <div style="background-color: #7e678c" class="text-center">
                        <h1 class="no-margin">&lt;- Cycle: 6 -&gt;</h1>
                    </div>
                </div>
                <div class="row-fluid bottom">
                    <!-- <form class="form-inline" ng-show="showFilter">
                         <div class="form-group">
                             <label for="exampleInputName2" class="hidden-xs">
                         <span class="fa"
                               ng-class="{'fa-caret-up' : $ctrl.sort === 'name ASC', 'fa-caret-down' : $ctrl.sort === 'name DESC'}"></span>
                                 <span class="inventory-toggle-sort" ng-click="$ctrl.toggleSort('name')">Name</span>
                             </label>
                             <input placeholder="Name" type="text" class="form-control input-sm" ng-model="$ctrl.filter.name"
                                    ng-change="$ctrl.handleFilterChange()"
                                    ng-model-options="{ allowInvalid: true, debounce: 200 }">
                             <span class="fa fa-remove generic-remove-btn" ng-show="$ctrl.filter.name"
                                   ng-click="$ctrl.clearFilterItem('name')">&nbsp;</span>
                         </div>
                         <div class="form-group">
                             <label for="exampleInputName2" class="hidden-xs">
                         <span class="fa"
                               ng-class="{'fa-caret-up' : $ctrl.sort === 'category_id ASC', 'fa-caret-down' : $ctrl.sort === 'category_id DESC'}"></span>
                                 <span class="inventory-toggle-sort" ng-click="$ctrl.toggleSort('category_id')">Category</span>
                             </label>
                             <select ng-change="$ctrl.handleFilterChange()"
                                     ng-model-options="{ allowInvalid: true, debounce: 200 }"
                                     class="form-control input-sm"
                                     ng-options="category.category_id as category.name for category in $ctrl.categories"
                                     ng-model="$ctrl.filter.category_id">
                                 <option>asdf</option>
                             </select>

                             <span class="fa fa-remove generic-remove-btn" ng-show="$ctrl.filter.category_id"
                                   ng-click="$ctrl.clearFilterItem('category_id')">&nbsp;</span>
                         </div>
                         <div class="form-group">
                             <label for="exampleInputName2" class="hidden-xs">
                         <span class="fa"
                               ng-class="{'fa-caret-up' : $ctrl.sort === 'quantity ASC', 'fa-caret-down' : $ctrl.sort === 'quantity DESC'}"></span>
                                 <span class="inventory-toggle-sort" ng-click="$ctrl.toggleSort('quantity')">Quantity</span>
                             </label>
                             &lt;!&ndash;<select  class="form-control input-sm" ng-model="$ctrl.filter.quantityMod">
                                 <option >==</option>
                                 <option >&gt;</option>
                                 <option >&lt;</option>

                             </select>&ndash;&gt;
                             <input style="width:100px;" ng-model="$ctrl.filter.quantity" type="number"
                                    class="form-control input-sm" id="exampleInputName2" placeholder="0"
                                    ng-change="$ctrl.handleFilterChange()"
                                    ng-model-options="{ allowInvalid: true, debounce: 200 }">
                             <span class="fa fa-remove generic-remove-btn " ng-show="$ctrl.filter.quantity"
                                   ng-click="$ctrl.clearFilterItem('quantity')">&nbsp;</span>
                         </div>
                     </form>-->
                </div>

            </div>
        </div>
    </div>
    <div class="inventory-table-wrapper">
        <div ng-switch="$ctrl.InventoryService.mode">
            <div ng-switch-when="shrink">
                <table class="table table-striped inventory-table">
                    <tbody>
                    <tr ng-show="!$ctrl.currentItems.length">
                        <td>No results.</td>
                    </tr>
                    <tr class="bigger-text inventory-row" ng-repeat="item in $ctrl.currentItems"
                        ng-init="$item = $ctrl.getItem(item.item_id)"
                        ng-class="{'inventory-row-dirty' : $item.isDirty()}">

                        <td>{{item.name}}&nbsp;&nbsp;<span class="hidden-xs">({{item.unit}})</span></td>

                        <td valign="center"
                            ng-swipe-right="$ctrl.decrementQuantity($item)"
                            ng-swipe-left="$ctrl.incrementQuantity($item)"
                            style="padding:0;"
                            id="{{'item-slider-' + item.item_id}}" class="inv-slider">

                            <span ng-switch="!!$item._changes.quantity" class="no-animate">
                                <span ng-switch-default>{{$item.quantity}}
                                    <span ng-class="$item._changes.quantity > 0 ? 'positive' : 'negative'"
                                          class="signed">
                                    {{$item._changes.quantity>0?$item._changes.quantity:($item._changes.quantity*-1) || ''}}
                                    </span>
                                </span>
                                <span ng-switch-when="false" class="">
                                    shrink&nbsp;<span class="inventory-swiper fa fa-arrow-right"></span>
                                </span>
                            </span>
                        </td>

                        <td class="inventory-total-col">
                        <span ng-class="{'positive' : $item._changes.quantity > 0, 'negative': $item._changes.quantity < 0}">
                            {{($item._changes.quantity || 0) + item.quantity}}
                        </span>
                        </td>

                        <td class="text-right hidden-xs">
                            <span class="btn btn-default fa fa-plus" ng-click="$ctrl.incrementQuantity($item)"
                                  ng-class="!$item._changes.quantity  ? 'disabled' : ''"></span>
                            <span class="btn btn-default fa fa-minus" ng-click="$ctrl.decrementQuantity($item)"
                                  ng-class="$item._changes.quantity + $item.quantity == 0 ? 'disabled' : ''"></span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div ng-switch-when="order">
                <table class="table table-striped inventory-table">
                    <tbody>
                    <tr ng-show="!$ctrl.currentItems.length">
                        <td>No results.</td>
                    </tr>
                    <tr class="bigger-text inventory-row" ng-repeat="item in $ctrl.currentItems"
                        ng-init="$item = $ctrl.getItem(item.item_id)"

                        ng-class="{'inventory-row-dirty' : $item.isDirty()}">

                        <td>{{item.name}}&nbsp;&nbsp;<span class="hidden-xs">({{item.unit}})</span></td>
                        <td class="inventory-total-col">
                            {{item.quantity}}
                            <span ng-class="$item._changes.quantity > 0 ? 'positive' : 'negative'"
                                  ng-show="$item._changes.quantity">
                                ({{$item._changes.quantity + item.quantity}})
                            </span>
                        </td>
                        <td class="inventory-total-col">
                            {{item.cost | currency:"$" }}
                        </td>

                        <td class="text-right">
                            <input type="number" class="form-control" style="width:100px; display: inline-block;"
                                   ng-model="$item._changes.quantity" placeholder="0"
                                   ng-change="$ctrl.onOrderChange()" min="0">
                        </td>
                        <td class="inventory-total-col">
                            {{item.cost * $item._changes.quantity | currency:"$" }}
                        </td>

                    </tr>
                    </tbody>
                </table>
            </div>
            <div ng-switch-when="sale">
                <table class="table table-striped inventory-table">
                    <thead>
                    <tr>
                        <th>
                            name
                        </th>
                        <th>
                            cost
                        </th>
                        <th>
                            selling price (markup)
                        </th>
                        <th>
                            adjust price
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-show="!$ctrl.currentItems.length">
                        <td>No results.</td>
                    </tr>
                    <tr class="bigger-text inventory-row"
                        ng-repeat="item in $ctrl.currentItems"
                        ng-init="$item = $ctrl.getItem(item.item_id)"
                        ng-class="{'inventory-row-dirty' : $item.isDirty()}">

                        <td>{{item.name}}</td>

                        <td class="inventory-total-col">
                            {{item.cost | currency}} per {{item.unit}}
                        </td>

                        <td class="inventory-total-col">
                            <span ng-class="{'positive' : $item._changes.sell_price > item.sell_price, 'negative' : $item._changes.sell_price < item.sell_price}">
                                {{($item._changes.sell_price != null ? $item._changes.sell_price : item.sell_price) | currency}}
                                ({{((($item._changes.sell_price || item.sell_price) - item.cost) / item.cost) * 100 | number: 2}} %)
                            </span>
                        </td>

                        <td class="inventory-total-col">
                            <input type="number" class="form-control" style="width:100px; display: inline-block;"
                                   ng-model="$item._changes.sell_price"
                                   ng-value="item.sell_price"
                                   placeholder="{{item.sell_price}}"
                                   ng-change="$ctrl.InventoryService.save()"
                                   min="{{item.cost}}"/>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div ng-switch-when="report">
                <div class="well light">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    Basic panel example
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    Basic panel example
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    Basic panel example
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    Basic panel example
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div style="width: 100%;">
                                <highchart ng-if="$ctrl.chart" id="chart1" config="$ctrl.chart"></highchart>
                            </div>

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <table class="table table-responsive">
                                <tr>
                                    <th>Cycle ID</th>
                                    <th>Period</th>
                                    <th>Order</th>
                                    <th>Shrink</th>
                                    <th>Sale</th>
                                </tr>
                                <tr class="current-cycle">
                                    <td>5</td>
                                    <td>Apr 4 - 13</td>
                                    <td>2345</td>
                                    <td>5432</td>
                                    <td>1234</td>
                                </tr>

                            </table>

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="panel panel-default">
                                <div class="panel-heading">Server Log</div>
                                <ul class="list-group" style="height: 300px; overflow-y: auto">
                                    <li class="list-group-item">sold 3 units (box) of celery</li>
                                    <li class="list-group-item">sold 3 units (box) of celery</li>
                                    <li class="list-group-item">sold 3 units (box) of celery</li>
                                    <li class="list-group-item">sold 3 units (box) of celery</li>
                                    <li class="list-group-item">sold 3 units (box) of celery</li>
                                    <li class="list-group-item">sold 3 units (box) of celery</li>
                                    <li class="list-group-item">sold 3 units (box) of celery</li>
                                    <li class="list-group-item">sold 3 units (box) of celery</li>
                                    <li class="list-group-item">sold 3 units (box) of celery</li>
                                    <li class="list-group-item">sold 3 units (box) of celery</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-default">
                                <div class="panel-heading">Panel heading without title</div>
                                <div class="panel-body">
                                    Panel content
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <ul class="list-group">
                                <li class="list-group-item list-group-item-success">Dapibus ac facilisis in</li>
                                <li class="list-group-item list-group-item-info">Cras sit amet nibh libero</li>
                                <li class="list-group-item list-group-item-warning">Porta ac consectetur ac</li>
                                <li class="list-group-item list-group-item-danger">Vestibulum at eros</li>
                            </ul>
                        </div>
                    </div>


                </div>

            </div>
        </div>
    </div>
</div>
